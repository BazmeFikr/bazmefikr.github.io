<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dive into Magomed Shakhid’s Library — your gateway to Ilm and a rich, engaging Muslim environment.">
    <meta name="author" content="Magomed Shakhid">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://magomedshakhid.github.io/">
    
    <meta property="og:type" content="website">
    <meta property="og:title" content="Shakhid's Library">
    <meta property="og:description" content="Dive into Magomed Shakhid’s Library — your gateway to Ilm and a rich, engaging Muslim environment.">
    <meta property="og:url" content="https://magomedshakhid.github.io/">
    <meta property="og:image" content="/images/og-image(1).jpeg">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Shakhid's Library">
    <meta name="twitter:description" content="Dive into Magomed Shakhid’s Library — your gateway to Ilm and a rich, engaging Muslim environment.">
    <meta name="twitter:image" content="/images/og-image(1).jpeg">
    <!-- Favicon and icons -->
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="theme-color" content="#800020">
    <title>Shakhid's Library</title>
    <style>
        :root {
            --color-bg: #fff8e7;
            --color-main: #fff;
            --color-text: #333;
            --color-header-bg: linear-gradient(90deg, #800020 0%, #9a1750 100%);
            --color-header-text: #fff;
            --color-nav-bg: linear-gradient(90deg, #ff7b00 0%, #ff9a3c 100%);
            --color-nav-link: #fff;
            --color-nav-link-bg: #800020;
            --color-nav-link-hover-bg: #fff;
            --color-nav-link-hover: #800020;
            --color-article-bg: rgba(255,255,255,0.7);
            --color-article-title: #800020;
            --color-footer-bg: linear-gradient(90deg, #800020 0%, #9a1750 100%);
            --color-footer-text: rgba(255,255,255,0.9);
            --color-shadow: 0 4px 16px rgba(0,0,0,0.1);
            --color-border: 1px solid rgba(255,123,0,0.1);
        }
        body.dark-mode {
            --color-bg: #18171a;
            --color-main: #232228;
            --color-text: #e2e1e7;
            --color-header-bg: linear-gradient(90deg, #2d1a2e 0%, #3a223a 100%);
            --color-header-text: #f3e9f7;
            --color-nav-bg: linear-gradient(90deg, #3a223a 0%, #2d1a2e 100%);
            --color-nav-link: #e2e1e7;
            --color-nav-link-bg: #3a223a;
            --color-nav-link-hover-bg: #e2e1e7;
            --color-nav-link-hover: #3a223a;
            --color-article-bg: rgba(40,32,48,0.85);
            --color-article-title: #ffb347;
            --color-footer-bg: linear-gradient(90deg, #2d1a2e 0%, #3a223a 100%);
            --color-footer-text: #e2e1e7;
            --color-shadow: 0 4px 16px rgba(0,0,0,0.4);
            --color-border: 1px solid rgba(255,255,255,0.07);
        }
        html, body {
            height: 100%;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: var(--color-text);
            background: var(--color-bg);
            transition: background 0.3s, color 0.3s;
        }
        header {
            background: var(--color-header-bg);
            color: var(--color-header-text);
            padding: 1.5rem 0 1.1rem 0;
            text-align: center;
            border-bottom: 1.5px solid rgba(255,255,255,0.1);
            box-shadow: 0 2px 8px rgba(128,0,32,0.2);
        }
        header h1 {
            font-size: 2.1em;
            margin: 0 0 0.25em 0;
            font-weight: 700;
            letter-spacing: 0.01em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        header p {
            font-size: 1.13em;
            margin: 0 0 0.1em 0;
            color: rgba(255,255,255,0.9);
        }
        nav {
            background: var(--color-nav-bg);
            padding: 0.5rem 0;
            text-align: center;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.4em;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 2px 8px rgba(255,123,0,0.15);
        }
        nav a {
            color: var(--color-nav-link);
            background: var(--color-nav-link-bg);
            margin: 0 0.2rem;
            text-decoration: none;
            font-weight: 600;
            display: inline-block;
            padding: 0.4em 1em;
            border-radius: 18px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.2s ease;
            font-size: 1em;
            letter-spacing: 0.01em;
            margin-bottom: 0.2em;
            min-width: 90px;
            backdrop-filter: blur(5px);
        }
        nav a:hover, nav a.active {
            background: var(--color-nav-link-hover-bg);
            color: var(--color-nav-link-hover);
            box-shadow: 0 4px 12px rgba(128,0,32,0.18);
            transform: translateY(-1px);
            border-color: #800020;
        }
        #darkmode-toggle {
            margin-left: 1em;
            padding: 0.4em 1.2em;
            border-radius: 18px;
            font-weight: 600;
            font-size: 1em;
            background: #222;
            color: #fff;
            border: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.13);
            cursor: pointer;
            transition: background 0.2s;
        }
        body.dark-mode #darkmode-toggle {
            background: #ffe6a7;
            color: #2d1a2e;
        }
        #darkmode-toggle:hover {
            background: #333;
        }
        main {
            width: 100%;
            max-width: 800px;
            margin: 2rem auto;
            background: var(--color-main);
            color: var(--color-text);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: var(--color-shadow);
            border: var(--color-border);
            flex: 1 0 auto;
            display: block;
        }
        article {
            margin-bottom: 2rem;
            background: var(--color-article-bg);
            color: var(--color-text);
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 18px 0 rgba(128,0,32,0.10), 0 1.5px 8px 0 rgba(255,123,0,0.07); /* Modern minimal shadow */
        }
        article h2 {
            margin-top: 0;
            color: var(--color-article-title);
        }
        article a {
            color: var(--color-article-title);
            text-decoration: none;
            transition: color 0.2s;
        }
        article a:hover {
            color: #ff7b00;
        }
        footer {
            text-align: center;
            padding: 0.7rem 0 0.5rem 0;
            background: var(--color-footer-bg);
            color: var(--color-footer-text);
            margin-top: 2rem;
            font-size: 0.98em;
            border-top: 1.5px solid rgba(255,255,255,0.1);
            box-shadow: 0 -2px 8px rgba(128,0,32,0.2);
            flex-shrink: 0;
        }
        @media (max-width: 900px) {
            main {
                width: 98vw;
                max-width: 98vw;
                min-width: 0;
                box-sizing: border-box;
                padding: 1.2rem;
                margin: 1rem auto;
            }
        }
        @media (max-width: 600px) {
            header {
                padding: 1.1rem 0 0.7rem 0;
            }
            header h1 {
                font-size: 1.35em;
            }
            header p {
                font-size: 1em;
            }
            nav {
                padding: 0.3rem;
            }
            nav a {
                flex: 1 1 40%;
                max-width: 120px;
                min-width: 70px;
                margin: 0.18em;
                font-size: 0.97em;
                padding: 0.45em 0.1em;
            }
            main {
                width: 100vw;
                max-width: 100vw;
                min-width: 0;
                box-sizing: border-box;
                padding: 0.7rem 0.7rem;
                border-radius: 8px;
                margin: 0.7rem auto 0.7rem auto;
            }
            article {
                padding: 0.8rem 0.5rem;
            }
            h2, h1, p, ul, li, div {
                margin-left: 0.1em;
                margin-right: 0.1em;
            }
            article h2 {
                font-size: 1.1em;
            }
            footer {
                font-size: 0.93em;
                padding: 0.5rem 0 0.3rem 0;
            }
        }
        .media-container {
            margin: 1.5em 0;
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
        }
        .media-container iframe, .media-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
        }
        /* Ensure images inside media-container always fit the main article div */
        .media-container img {
            display: block;
            max-width: 100%;
            width: 100%;
            height: auto;
            margin: 0 auto;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            object-fit: cover;
            aspect-ratio: 16/9;
        }
        /* Dark mode for media containers */
        body.dark-mode .media-container {
            background: #232228;
            box-shadow: 0 2px 12px rgba(0,0,0,0.4);
        }
        body.dark-mode .media-container img {
            box-shadow: 0 2px 12px rgba(0,0,0,0.4);
        }
        /* Dark mode for webapps cards */
        body.dark-mode .webapp-card {
            background: #232228 !important;
            color: #e2e1e7 !important;
            box-shadow: 0 2px 12px rgba(0,0,0,0.4) !important;
        }
        body.dark-mode .webapp-card img {
            filter: invert(1) brightness(2) contrast(1.5) drop-shadow(0 1px 2px #aaa);
            background: #fff;
            padding: 8px;
            border-radius: 50%;
            box-shadow: 0 1px 4px rgba(0,0,0,0.18);
            transition: filter 0.2s, background 0.2s;
        }
        /* Dark mode for library details and links */
        body.dark-mode .lib-details {
            background: #232228 !important;
            color: #e2e1e7 !important;
            border-radius: 10px;
        }
        body.dark-mode .lib-details a {
            color: #ffb347 !important;
        }
        body.dark-mode .lib-details a:hover {
            color: #ff7b00 !important;
        }
        /* Dark mode for search section */
        body.dark-mode #main-content ul, body.dark-mode #main-content li, body.dark-mode #main-content p, body.dark-mode #main-content h2 {
            background: transparent !important;
            color: #e2e1e7 !important;
        }
        body.dark-mode #main-content div {
            color: #bdb7c6 !important;
        }
        body.dark-mode #main-content a {
            color: #ffb347 !important;
        }
        body.dark-mode #main-content a:hover {
            color: #ff7b00 !important;
        }
    </style>
</head>
<body>
    <header>
        <h1>Shakhid's Library</h1>
        <p>Welcome to my personal library!</p>
    </header>
    <nav>
        <a href="#" id="myblog-link">MyBlog</a>
        <a href="#" id="webapps-link">Webapps</a>
        <a href="#" id="libraries-link">Libraries</a>
        <a href="#" id="search-link">Search</a>
        <button id="darkmode-toggle" aria-label="Toggle dark mode" style="margin-left:1em;padding:0.4em 1.2em;border-radius:18px;font-weight:600;font-size:1em;background:#222;color:#fff;border:none;box-shadow:0 2px 8px rgba(0,0,0,0.13);cursor:pointer;transition:background 0.2s;">🌙 Dark</button>
    </nav>
    <main id="main-content">
        <!-- Articles will be loaded here dynamically -->
    </main>
    <script>
    // Fetch and display article previews on page load
    window.addEventListener('DOMContentLoaded', () => fetchArticlePreviews('', false));

    document.getElementById('myblog-link').addEventListener('click', function(e) {
        e.preventDefault();
        fetchArticlePreviews('', true);
    });

    document.getElementById('webapps-link').addEventListener('click', function(e) {
        e.preventDefault();
        fetchWebapps();
    });

    document.getElementById('libraries-link').addEventListener('click', function(e) {
        e.preventDefault();
        fetchLibraries();
    });

    document.getElementById('search-link').addEventListener('click', function(e) {
        e.preventDefault();
        showBaseSearch();
    });

    async function fetchWebapps() {
        const main = document.getElementById('main-content');
        main.innerHTML = '<p>Loading webapps...</p>';
        try {
            const res = await fetch('webapps.txt');
            if (!res.ok) throw new Error('Not found');
            const text = await res.text();
            const lines = text.split('\n').filter(line => line.trim() !== '');
            let html = '<h2>Webapps Shortcuts</h2><div style="display:flex;flex-wrap:wrap;gap:2em;justify-content:center;">';
            for (const line of lines) {
                const [name, url] = line.split(',');
                if (name && url) {
                    // Try to get the favicon from the website
                    let domain;
                    try {
                        domain = new URL(url).origin;
                    } catch { domain = url; }
                    const favicon = domain + '/favicon.ico';
                    html += `<div class="webapp-card" style="width:120px;text-align:center;background:var(--color-main);border-radius:14px;padding:1em 0;box-shadow:0 2px 12px 0 rgba(40,40,40,0.08), 0 1.5px 8px 0 rgba(255,123,0,0.07);cursor:pointer;transition:box-shadow 0.2s;">
                        <a href="${url}" target="_blank" style="display:block;text-decoration:none;color:inherit;">
                            <img src="${favicon}" alt="${name} icon" style="width:48px;height:48px;object-fit:contain;margin-bottom:0.5em;filter:drop-shadow(0 1px 2px #aaa);">
                            <div style="font-size:1em;font-weight:bold;">${name}</div>
                        </a>
                    </div>`;
                }
            }
            html += '</div>';
            main.innerHTML = html;
        } catch {
            main.innerHTML = '<p>Could not load webapps.</p>';
        }
    }

    async function fetchLibraries() {
        const main = document.getElementById('main-content');
        main.innerHTML = '<p>Loading libraries...</p>';
        try {
            const res = await fetch('libraries.txt');
            if (!res.ok) throw new Error('Not found');
            const text = await res.text();
            const categories = {};
            let current = '';
            let parent = '';
            text.split('\n').forEach(line => {
                if (line.startsWith('[') && line.endsWith(']')) {
                    const cat = line.slice(1, -1);
                    if (["Language","History","Philosophy","Science"].includes(cat)) {
                        current = cat;
                        parent = 'Knowledge';
                        if (!categories[parent]) categories[parent] = {};
                        categories[parent][current] = [];
                    } else if (["Preserved","Distorted"].includes(cat)) {
                        current = cat;
                        parent = 'Wisdom';
                        if (!categories[parent]) categories[parent] = {};
                        categories[parent][current] = [];
                    } else {
                        current = cat;
                        parent = '';
                        categories[current] = [];
                    }
                } else if (line.includes(',') && current) {
                    if (parent === 'Knowledge' && current !== 'Knowledge') {
                        categories[parent][current].push(line);
                    } else if (parent === 'Wisdom' && current !== 'Wisdom') {
                        categories[parent][current].push(line);
                    } else if (!parent) {
                        categories[current].push(line);
                    }
                }
            });
            let html = `<h2>Digital Libraries</h2>
                <div style="margin-bottom:1em;display:flex;gap:1em;">
                    <button id="expand-all-btn" style="background:#ff7b00;color:#fff;border:none;padding:0.5em 1.2em;border-radius:18px;font-weight:bold;cursor:pointer;box-shadow:0 2px 8px rgba(255,123,0,0.13);">Expand All</button>
                    <button id="collapse-all-btn" style="background:#800020;color:#fff;border:none;padding:0.5em 1.2em;border-radius:18px;font-weight:bold;cursor:pointer;box-shadow:0 2px 8px rgba(128,0,32,0.13);">Collapse All</button>
                </div>`;
            for (const cat of ['Wisdom','Intelligence','Knowledge','Skill','Earning']) {
                if (cat === 'Wisdom') {
                    if (categories['Wisdom']) {
                        html += `<details class="lib-details" style=\"margin-bottom:1.5em;\"><summary style=\"font-size:1.2em;font-weight:bold;cursor:pointer;\">Wisdom</summary>`;
                        for (const sub of ['Preserved','Distorted']) {
                            if (categories['Wisdom'][sub] && categories['Wisdom'][sub].length) {
                                html += `<details class="lib-details" style=\"margin:0.5em 0 0 1.5em;\"><summary style=\"font-size:1em;font-weight:bold;cursor:pointer;\">${sub}</summary><ul style=\"margin:0.5em 0 0 1.5em;padding:0;list-style:disc;\">`;
                                for (const entry of categories['Wisdom'][sub]) {
                                    const [name, url] = entry.split(',');
                                    html += `<li style=\"margin-bottom:0.7em;\"><a href=\"${url}\" target=\"_blank\" style=\"font-size:1em;\">${name}</a></li>`;
                                }
                                html += '</ul></details>';
                            }
                        }
                        html += '</details>';
                    }
                } else if (cat === 'Knowledge') {
                    if (categories['Knowledge']) {
                        html += `<details class="lib-details" style=\"margin-bottom:1.5em;\"><summary style=\"font-size:1.2em;font-weight:bold;cursor:pointer;\">Knowledge</summary>`;
                        for (const sub of ['Language','History','Philosophy','Science']) {
                            if (categories['Knowledge'][sub] && categories['Knowledge'][sub].length) {
                                html += `<details class="lib-details" style=\"margin:0.5em 0 0 1.5em;\"><summary style=\"font-size:1em;font-weight:bold;cursor:pointer;\">${sub}</summary><ul style=\"margin:0.5em 0 0 1.5em;padding:0;list-style:disc;\">`;
                                for (const entry of categories['Knowledge'][sub]) {
                                    const [name, url] = entry.split(',');
                                    html += `<li style=\"margin-bottom:0.7em;\"><a href=\"${url}\" target=\"_blank\" style=\"font-size:1em;\">${name}</a></li>`;
                                }
                                html += '</ul></details>';
                            }
                        }
                        html += '</details>';
                    }
                } else {
                    if (categories[cat] && categories[cat].length) {
                        html += `<details class="lib-details" style="margin-bottom:1.5em;background:var(--color-main);"><summary style="font-size:1.2em;font-weight:bold;cursor:pointer;">${cat}</summary><ul style="margin:1em 0 0 1.5em;padding:0;list-style:disc;">`;
                        for (const entry of categories[cat]) {
                            const [name, url] = entry.split(',');
                            html += `<li style="margin-bottom:0.7em;"><a href="${url}" target="_blank" style="font-size:1em;">${name}</a></li>`;
                        }
                        html += '</ul></details>';
                    }
                }
            }
            main.innerHTML = html;
            // Add expand/collapse all logic
            document.getElementById('expand-all-btn').onclick = () => {
                document.querySelectorAll('.lib-details').forEach(d => d.open = true);
            };
            document.getElementById('collapse-all-btn').onclick = () => {
                document.querySelectorAll('.lib-details').forEach(d => d.open = false);
            };
        } catch {
            main.innerHTML = '<p>Could not load libraries.</p>';
        }
    }

    // Optimized: Paginate article previews for large numbers

    const ARTICLES_PER_PAGE = 10;
    let allArticleMeta = [];
    let loadedArticlePreviews = [];
    let currentArticlePage = 0;

    async function fetchArticlePreviews(searchTerm = '', showSearch = true) {
        const main = document.getElementById('main-content');
        main.innerHTML = `<div id='blog-articles'></div><div id='load-more-container' style='text-align:center;margin:2em 0;'></div>`;
        // Only fetch the index file for instant load
        if (!allArticleMeta.length) {
            try {
                const res = await fetch('articles/index.txt');
                if (res.ok) {
                    // Each line: file,date
                    allArticleMeta = (await res.text()).split('\n').filter(f => f.trim()).map(line => {
                        const [file, date] = line.split(',');
                        return {file: file.trim(), date: (date||'').trim()};
                    }).sort((a, b) => new Date(b.date) - new Date(a.date));
                } else {
                    document.getElementById('blog-articles').innerHTML = '<p>No articles found (missing index.txt).</p>';
                    return;
                }
            } catch {
                document.getElementById('blog-articles').innerHTML = '<p>No articles found (error loading index.txt).</p>';
                return;
            }
        }
        loadedArticlePreviews = [];
        currentArticlePage = 0;
        await loadNextArticlePage();
    }

    async function loadNextArticlePage() {
        const start = currentArticlePage * ARTICLES_PER_PAGE;
        const end = start + ARTICLES_PER_PAGE;
        const metaToLoad = allArticleMeta.slice(start, end);
        if (!metaToLoad.length) return;
        // Fetch only the next batch
        const texts = await Promise.all(metaToLoad.map(meta => fetch(meta.file, {cache: 'reload'}).then(res => res.ok ? res.text() : null).catch(() => null)));
        let articles = [];
        for (let i = 0; i < metaToLoad.length; i++) {
            const text = texts[i];
            if (!text) continue;
            const [titleLine, dateLine, , ...bodyLines] = text.split('\n');
            const title = titleLine ? titleLine.replace('Title: ', '') : '';
            const date = dateLine ? dateLine.replace('Date: ', '') : metaToLoad[i].date;
            const body = bodyLines.join(' ');
            if (title && date) {
                articles.push({file: metaToLoad[i].file, title, date, body});
            }
        }
        loadedArticlePreviews = loadedArticlePreviews.concat(articles);
        renderArticlePreviews();
        currentArticlePage++;
        // Show/hide Load More button
        const loadMoreContainer = document.getElementById('load-more-container');
        if (currentArticlePage * ARTICLES_PER_PAGE < allArticleMeta.length) {
            loadMoreContainer.innerHTML = `<button id='load-more-btn' style='background:#ff7b00;color:#fff;border:none;padding:0.7em 2em;border-radius:18px;font-weight:bold;cursor:pointer;box-shadow:0 2px 8px rgba(255,123,0,0.13);font-size:1.1em;'>Load More</button>`;
            document.getElementById('load-more-btn').onclick = loadNextArticlePage;
        } else {
            loadMoreContainer.innerHTML = '';
        }
    }

    function renderArticlePreviews() {
        let html = '';
        for (const a of loadedArticlePreviews) {
            const sentences = a.body.match(/[^.!?\n]+[.!?]+/g) || [];
            const preview = sentences.slice(0, 2).join(' ');
            html += `<article><h2><a href="#" class="article-link" data-file="${a.file}">${a.title}</a></h2><p><em>${a.date}</em></p><p>${preview}...</p></article>`;
        }
        document.getElementById('blog-articles').innerHTML = html || '<p>No articles found.</p>';
        document.querySelectorAll('.article-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const file = this.getAttribute('data-file');
                showFullArticle(file);
            });
        });
    }

    async function showFullArticle(file) {
        const main = document.getElementById('main-content');
        main.innerHTML = '<p>Loading article...</p>';
        try {
            const res = await fetch(file);
            if (!res.ok) throw new Error('Not found');
            const text = await res.text();
            const [titleLine, dateLine, , ...bodyLines] = text.split('\n');
            const title = titleLine.replace('Title: ', '');
            const date = dateLine.replace('Date: ', '');
            let body = bodyLines.join('\n');

            // Replace [image:], [video:], [pdf:] tags
            body = body.replace(/\[(image|video|pdf):([^\]]+)\]/g, (match, type, url) => {
                return embedMedia(url, type);
            });
            // Replace bare links to images, videos, pdfs, and YouTube
            body = body.replace(/(https?:\/\/[\w\-\./%#?=&]+\.(?:png|jpe?g|gif|webp|bmp|svg))/gi, (url) => {
                return embedMedia(url, 'image');
            });
            body = body.replace(/(https?:\/\/[\w\-\./%#?=&]+\.(?:mp4|webm|ogg))/gi, (url) => {
                return embedMedia(url, 'video');
            });
            body = body.replace(/(https?:\/\/[\w\-\./%#?=&]+\.(?:pdf))/gi, (url) => {
                return embedMedia(url, 'pdf');
            });
            // YouTube links
            body = body.replace(/(https?:\/\/(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)[\w\-]+)/gi, (url) => {
                return embedMedia(url, 'video');
            });

            function embedMedia(url, type) {
                if (type === 'image') {
                    return `<div class=\"media-container\" style=\"padding-bottom:0;position:relative;height:auto;overflow:visible;\"><img src=\"${url}\" alt=\"Article image\" style=\"display:block;max-width:100%;width:auto;height:auto;margin:0 auto;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,0.1);\"></div>`;
                } else if (type === 'video') {
                    // YouTube
                    if (/youtube\.com\/watch\?v=|youtu\.be\//.test(url)) {
                        let videoId = '';
                        if (url.includes('youtu.be/')) {
                            videoId = url.split('youtu.be/')[1].split(/[?&]/)[0];
                        } else {
                            const match = url.match(/[?&]v=([\w\-]+)/);
                            videoId = match ? match[1] : '';
                        }
                        if (videoId) {
                            return `<div class=\"media-container\"><iframe src=\"https://www.youtube.com/embed/${videoId}\" style=\"position:absolute;top:0;left:0;width:100%;height:100%;border:none;border-radius:8px;\" allowfullscreen></iframe></div>`;
                        }
                    }
                    // Vimeo
                    if (url.includes('vimeo.com')) {
                        const videoId = url.split('/').pop();
                        return `<div class=\"media-container\"><iframe src=\"https://player.vimeo.com/video/${videoId}\" style=\"position:absolute;top:0;left:0;width:100%;height:100%;border:none;border-radius:8px;\" allowfullscreen></iframe></div>`;
                    }
                    // Direct video
                    return `<div class=\"media-container\" style=\"padding-bottom:0;position:relative;height:auto;overflow:visible;\"><video controls style=\"width:100%;border-radius:8px;\"><source src=\"${url}\" type=\"video/mp4\">Your browser does not support the video tag.</video></div>`;
                } else if (type === 'pdf') {
                    return `<div class=\"media-container\" style=\"position:relative;padding-bottom:100%;height:0;overflow:hidden;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,0.1);margin:1.5em 0;\"><iframe src=\"${url}\" style=\"position:absolute;top:0;left:0;width:100%;height:100%;border:none;border-radius:8px;\"></iframe></div>`;
                }
                return url;
            }

            main.innerHTML = `
                <article>
                    <h2>${title}</h2>
                    <p><em>${date}</em></p>
                    <div style=\"margin-top:1.5em;\">${body}</div>
                </article>
                <button id=\"back-btn\" style=\"margin-top:2em;background:#800020;color:#fff;border:none;padding:0.7em 1.5em;border-radius:18px;font-weight:bold;cursor:pointer;box-shadow:0 2px 8px rgba(128,0,32,0.13);\">&larr; Back to articles</button>`;
            document.getElementById('back-btn').onclick = fetchArticlePreviews;
        } catch {
            main.innerHTML = '<p>Article not found.</p>';
        }
    }

    function showBaseSearch() {
        const main = document.getElementById('main-content');
        main.innerHTML = `
            <h2>Academic & Digital Search Engines</h2>
            <p style="max-width:700px;margin:0 auto 1.5em auto;font-size:1.08em;color:#444;text-align:center;">
                Explore a curated list of global academic, open access, and digital library search engines. These resources help you discover scholarly articles, books, theses, research data, and more from a wide range of disciplines and languages.
            </p>
            <ul style="margin:1.5em 0 0 0;padding:0;list-style:none;display:flex;flex-wrap:wrap;gap:1.2em;justify-content:center;">
                <li style='max-width:260px;'><a href="https://www.base-search.net/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">BASE</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>One of the world's largest academic search engines for scholarly web resources.</div></li>
                <li style='max-width:260px;'><a href="https://roar.eprints.org/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">ROAR</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>Registry of Open Access Repositories worldwide.</div></li>
                <li style='max-width:260px;'><a href="https://www.semanticscholar.org/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">Semantic Scholar</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>AI-powered search for scientific literature across disciplines.</div></li>
                <li style='max-width:260px;'><a href="https://www.lens.org/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">Lens.org</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>Open platform for scholarly works, patents, and innovation data.</div></li>
                <li style='max-width:260px;'><a href="https://core.ac.uk/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">CORE</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>Aggregates millions of open access research papers from repositories and journals.</div></li>
                <li style='max-width:260px;'><a href="https://eric.ed.gov/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">ERIC</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>Education-focused database of articles, reports, and research.</div></li>
                <li style='max-width:260px;'><a href="https://explore.openaire.eu/search/find/projects" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">OpenAIRE</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>European infrastructure for open access research outputs and projects.</div></li>
                <li style='max-width:260px;'><a href="https://doaj.org/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">DOAJ</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>Directory of Open Access Journals covering all scientific disciplines.</div></li>
                <li style='max-width:260px;'><a href="https://shamela.ws/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">Shamela</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>Large digital library of Arabic Islamic books and manuscripts.</div></li>
                <li style='max-width:260px;'><a href="https://www.islamport.com/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">Islamport</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>Comprehensive Arabic Islamic library and research portal.</div></li>
                <li style='max-width:260px;'><a href="https://www.noormags.ir/view/en/default" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">Noormags</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>Persian and Arabic academic journals and articles database.</div></li>
                <li style='max-width:260px;'><a href="https://www.cnki.net/index/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">CNKI</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>China National Knowledge Infrastructure for Chinese academic resources.</div></li>
                <li style='max-width:260px;'><a href="https://www.wanfangdata.com.cn/" target="_blank" style="display:block;padding:0.7em 1.5em;background:#2a4d69;color:#fff;border-radius:6px;font-size:1.1em;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.07);">Wanfang Data</a><div style='font-size:0.97em;color:#444;margin-top:0.4em;'>Major Chinese database for academic journals, dissertations, and more.</div></li>
            </ul>
        `;
    }

    // Dark mode logic
    const darkToggle = document.getElementById('darkmode-toggle');
    function setDarkMode(on) {
        if (on) {
            document.body.classList.add('dark-mode');
            darkToggle.textContent = '☀️ Light';
            localStorage.setItem('darkMode', '1');
        } else {
            document.body.classList.remove('dark-mode');
            darkToggle.textContent = '🌙 Dark';
            localStorage.setItem('darkMode', '0');
        }
    }
    // Initial mode from system or localStorage
    (function() {
        let dark = localStorage.getItem('darkMode');
        if (dark === null) {
            dark = window.matchMedia('(prefers-color-scheme: dark)').matches ? '1' : '0';
        }
        setDarkMode(dark === '1');
    })();
    darkToggle.onclick = function() {
        setDarkMode(!document.body.classList.contains('dark-mode'));
    };

    </script>
    <footer>
        &copy; 2025 Shakhid. All rights reserved.
    </footer>
</body>
</html>
<!-- Minimal UI enhancements: No extra markup needed here -->
